<!DOCTYPE html>
<html lang="zh-Hant">
    <head>
        <meta charset="UTF-8" />
        <title>æ–°å¢ç”¨æˆ¶</title>
        <link rel="stylesheet" href="main.css" />
        <style>
            .form-hint {
                font-size: 12px;
                color: #666;
                margin-top: 5px;
                font-style: italic;
            }

            .required {
                color: red;
            }

            .usage-time-display {
                font-size: 11px;
                color: #999;
                margin-top: 3px;
                opacity: 0.7;
            }
        </style>
    </head>
    <body>
        <h2>ğŸ‘¤ æ–°å¢ç”¨æˆ¶</h2>

        <label for="user_name">ç”¨æˆ¶åç¨± <span class="required">*</span></label>
        <input type="text" id="user_name" placeholder="è«‹è¼¸å…¥ç”¨æˆ¶åç¨±" required />
        <div class="form-hint">ç”¨æˆ¶åç¨±ä¸å¯é‡è¤‡</div>

        <label for="password">å¯†ç¢¼ <span class="required">*</span></label>
        <input type="password" id="password" placeholder="è«‹è¼¸å…¥å¯†ç¢¼" required />

        <div class="usage-time-display">ğŸ’¡ ä½¿ç”¨æ™‚é–“çµ±è¨ˆï¼šæ–°ç”¨æˆ¶åˆå§‹ç‚º 00:00:00ï¼Œç³»çµ±æœƒè‡ªå‹•å¾ç™»å…¥é–‹å§‹ç´¯è¨ˆä½¿ç”¨æ™‚é–“</div>

        <button>æ–°å¢ç”¨æˆ¶</button>

        <script>
            // æ–°å¢ç”¨æˆ¶å‡½æ•¸
            window.insertpost = async function () {
                // å–å¾—è¡¨å–®è³‡æ–™
                let userName = document.getElementById("user_name").value.trim();
                let password = document.getElementById("password").value.trim();
                let usageTime = "00:00:00"; // åˆå§‹ä½¿ç”¨æ™‚é–“
                let state = "0";
                console.log("è³‡æ–™:", { userName, password, usageTime, state });

                if (userName && password) {
                    await fetch(`http://localhost:8000/api/2/insert`, {
                        headers: {
                            "Content-Type": "application/json",
                        },
                        method: "POST",
                        mode: "cors",
                        body: JSON.stringify({
                            table: "users",
                            user_name: userName,
                            password: password,
                            usage_time: "00:00:00",
                            state: state,
                        }),
                    })
                        .then((response) => {
                            console.log("Status:", response.status);
                            if (response.ok) {
                                alert("æ–°å¢æˆåŠŸï¼");
                                document.getElementById("user_name").value = "";
                                document.getElementById("password").value = "";
                            } else {
                                alert("æ–°å¢å¤±æ•—ï¼Œç‹€æ…‹ç¢¼ï¼š" + response.status);
                            }
                        })
                        .catch((error) => {
                            console.error("Error:", error);
                            alert("æ–°å¢å¤±æ•—ï¼Œè«‹ç¨å¾Œå†è©¦");
                        });
                } else {
                    alert("è«‹è¼¸å…¥è³‡æ–™");
                }
            };

            console.log("DOM è¼‰å…¥å®Œæˆ");
            const btn = document.querySelector("button");
            console.log("æ‰¾åˆ°æŒ‰éˆ•:", btn);
            if (btn) {
                btn.addEventListener("click", function () {
                    console.log("æŒ‰éˆ•é»æ“Šäº‹ä»¶è§¸ç™¼");
                    window.insertpost();
                });
                console.log("äº‹ä»¶ç›£è½å™¨å·²ç¶å®š");
            }
            console.log("Script åŸ·è¡Œå®Œç•¢");
        </script>
    </body>
</html>
